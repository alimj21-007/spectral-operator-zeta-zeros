"""
test_operator.py
Spectral Operator and Comparison with Zeta Zeros
------------------------------------------------
این اسکریپت یک عملگر طیفی نمونه (مدل استورم–لیوویل گسسته) را شبیه‌سازی می‌کند،
مقادیر ویژه λ_n را محاسبه می‌کند، سپس نرمال‌سازی μ_n = α λ_n + β را اعمال کرده
و آن‌ها را با صفرهای زتای ریمان (γ_n) مقایسه می‌کند.
"""

import numpy as np

# -----------------------------
# تنظیمات
# -----------------------------
alpha = 0.5
beta = 10.0
N = 10  # تعداد مقادیر ویژه و صفرها

# -----------------------------
# داده‌های نمونه
# -----------------------------
# مقادیر ویژه نمونه (λ_n ≈ n^2 * π)
lambda_n = np.array([np.pi * n**2 for n in range(1, N+1)])

# نرمال‌سازی: μ_n = α λ_n + β
mu_n = alpha * lambda_n + beta

# ۱۰ صفر اول زتای ریمان (بخش موهومی)
gamma_n = np.array([
    14.134725141, 21.022039639, 25.010857580,
    30.424876125, 32.935061588, 37.586178159,
    40.918719012, 43.327073281, 48.005150881,
    49.773832478
])

# -----------------------------
# محاسبه اختلاف‌ها
# -----------------------------
residuals = np.abs(mu_n - gamma_n)
normalized_residuals = residuals / (1 + np.arange(1, N+1))**0.6

# -----------------------------
# چاپ نتایج
# -----------------------------
print("Spectral Operator and Comparison with Zeta Zeros")
print("------------------------------------------------")
print(f"{'n':>2} {'lambda_n':>12} {'mu_n':>12} {'gamma_n':>12} {'residual':>12} {'norm_resid':>12}")
for i in range(N):
    print(f"{i+1:2d} {lambda_n[i]:12.4f} {mu_n[i]:12.4f} {gamma_n[i]:12.4f} "
          f"{residuals[i]:12.4f} {normalized_residuals[i]:12.4f}")
