"""
test_stats.py
Spectral Operator and Comparison with Zeta Zeros
------------------------------------------------
این اسکریپت فاصله‌های بین صفرهای متوالی زتای ریمان (γ_n)
و فاصله‌های بین مقادیر طیفی نرمال‌شده μ_n = α λ_n + β
را محاسبه کرده و در قالب یک جدول مقایسه‌ای نمایش می‌دهد.
"""

import numpy as np

# -----------------------------
# تنظیمات
# -----------------------------
alpha = 0.5
beta = 10.0
N = 10  # تعداد مقادیر اولیه

# -----------------------------
# داده‌های نمونه
# -----------------------------
# مقادیر ویژه نمونه (λ_n ≈ π n^2)
lambda_n = np.array([np.pi * n**2 for n in range(1, N+2)])  # تا N+1 برای فاصله‌ها
mu_n = alpha * lambda_n + beta

# 11 صفر اول زتای ریمان (برای محاسبه فاصله‌های 1..10)
gamma_n = np.array([
    14.134725141, 21.022039639, 25.010857580,
    30.424876125, 32.935061588, 37.586178159,
    40.918719012, 43.327073281, 48.005150881,
    49.773832478, 52.970321478
])

# -----------------------------
# محاسبه فاصله‌ها
# -----------------------------
zeta_spacings = gamma_n[1:] - gamma_n[:-1]
spectral_spacings = mu_n[1:] - mu_n[:-1]

# -----------------------------
# چاپ نتایج
# -----------------------------
print("Spectral Operator and Comparison with Zeta Zeros")
print("Spacing Statistics (n=1..10)")
print("-------------------------------------------------------------")
print(f"{'n':>2} {'gamma_n':>12} {'gamma_{n+1}':>12} {'zeta_sp':>10} "
      f"{'mu_n':>12} {'mu_{n+1}':>12} {'spec_sp':>10}")
for i in range(N):
    print(f"{i+1:2d} {gamma_n[i]:12.4f} {gamma_n[i+1]:12.4f} {zeta_spacings[i]:10.4f} "
          f"{mu_n[i]:12.4f} {mu_n[i+1]:12.4f} {spectral_spacings[i]:10.4f}")
